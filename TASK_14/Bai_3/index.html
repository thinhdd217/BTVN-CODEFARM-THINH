<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        Array.prototype.filter2 = function (callback) {
  const result = [];
  const originalLength = this.length;

  for (let i = 0; i < originalLength; i++) {
    if (i in this) {
      if (callback(this[i], i, this)) {
        result.push(this[i]);
      }
    }
  }

  return result;
}; 
// Test 1: Mảng bình thường
const arr1 = [1, 2, 3, 4, 5];
const res1 = arr1.filter2(val => val % 2 !== 0);
console.log(res1); 

// Test 2: Mảng có empty slots
const arr2 = [1, , 3, , 5, , 7];
const res2 = arr2.filter2(val => val > 2);
console.log(res2);

// Test 3: Mảng rỗng
const arr3 = [];
console.log(arr3.filter2(() => true)); // []

// Test 4: Thay đổi mảng trong callback (không ảnh hưởng số lần lặp)
const arr4 = [10, 20, 30];
arr4.filter2((val, idx) => {
  arr4.push(999);
  return val > 15;
});

    </script>
</body>
</html>